From 397261f50368e2364818001929bd25c7610b41b5 Mon Sep 17 00:00:00 2001
From: Shoghi Cervantes <shoghicp@gmail.com>
Date: Sun, 24 Aug 2014 17:26:54 +0200
Subject: [PATCH] Added RakLib port checking option


diff --git a/src/pocketmine/network/RakLibInterface.php b/src/pocketmine/network/RakLibInterface.php
index b6ad89b..9e2953f 100644
--- a/src/pocketmine/network/RakLibInterface.php
+++ b/src/pocketmine/network/RakLibInterface.php
@@ -109,6 +109,9 @@ class RakLibInterface implements ServerInstance, SourceInterface{
 		$server = new RakLibServer($this->server->getLogger(), $this->server->getLoader(), $this->server->getPort(), $this->server->getIp() === "" ? "0.0.0.0" : $this->server->getIp());
 		$this->interface = new ServerHandler($server, $this);
 		$this->setName($this->server->getMotd());
+		if(!$server->getAdvancedProperty("main.session-port-checking", true)){
+			$this->setPortCheck(false);
+		}
 		$this->tickTask = $this->server->getScheduler()->scheduleRepeatingTask(new CallbackTask([$this, "doTick"]), 1);
 	}
 
diff --git a/src/pocketmine/resources/pocketmine-soft.yml b/src/pocketmine/resources/pocketmine-soft.yml
index ec89b09..2d59c9c 100644
--- a/src/pocketmine/resources/pocketmine-soft.yml
+++ b/src/pocketmine/resources/pocketmine-soft.yml
@@ -22,4 +22,8 @@ main:
 
  #Shuffle the player list to prevet players from 'gaming' the server, getting high priority on the tick list.
  #Value is in ticks, so 20 = shuffle each second
- player-shuffle: 0
\ No newline at end of file
+ player-shuffle: 0
+
+ #Enables RakLib client/server port checking
+ #Proxied servers might have to disable this option
+ session-port-checking: true
\ No newline at end of file
-- 
1.9.1

